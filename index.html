<script>
(function loadSubstackFeed(){
  const FEED = 'https://alphaandgrid.substack.com/feed';
  const PROXY = 'https://api.allorigins.win/raw?url=';
  const grid = document.getElementById('articulos-grid');
  if(!grid) return;

  // Mensaje en consola para ver si funciona
  console.log('Cargando artículos desde Substack...');

  fetch(PROXY + encodeURIComponent(FEED))
    .then(r => {
      if (!r.ok) throw new Error('HTTP ' + r.status);
      return r.text();
    })
    .then(xml => {
      const doc = new DOMParser().parseFromString(xml, 'text/xml');
      const items = Array.from(doc.querySelectorAll('item')).slice(0, 6);
      console.log('Artículos encontrados:', items.length);

      if (!items.length) throw new Error('No se encontraron artículos');

      grid.innerHTML = items.map(item => {
        const title = item.querySelector('title')?.textContent || 'Sin título';
        const link = item.querySelector('link')?.textContent || '#';
        const date = new Date(item.querySelector('pubDate')?.textContent || Date.now());
        const fecha = date.toLocaleDateString('es-ES',{day:'2-digit',month:'long',year:'numeric'});
        const descRaw = item.querySelector('description')?.textContent || '';
        const texto = descRaw.replace(/<!\[CDATA\[|\]\]>/g,'').replace(/<[^>]*>/g,'').trim();
        const snippet = texto.length > 160 ? texto.slice(0,157)+'…' : texto;

        return `
          <article class="card">
            <h3 style="margin-top:0">${title}</h3>
            <p class="subtle">${fecha}</p>
            <p>${snippet}</p>
            <p><a class="btn" href="${link}" target="_blank" rel="noopener">Leer en Substack</a></p>
          </article>
        `;
      }).join('');
    })
    .catch(err => {
      console.error('Error cargando feed:', err);
      grid.innerHTML = `<p>No se pudieron cargar los artículos ahora mismo.</p>`;
    });
})();
</script>






